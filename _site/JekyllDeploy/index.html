<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  

<meta name="description" content="This article describes the process of publishing static web site in automated way using rsync. Publishing Jekyll-generated content to hostgator hosting is used as an example.">


<meta name="keywords" content="jekyll, blogging, hostgator, hosting"/>


<!-- Facebook tags -->
<meta property="og:title" content="How to automatically deploy static web site to the hosting">
<meta property="og:type" content="article">
<meta property="og:url" content="http://localhost:4000/vr/JekyllDeploy//">
<meta property="og:image" content="http://localhost:4000/vr/public/images/me_hires.png">
<meta property="og:description" content="This article describes the process of publishing static web site in automated way using rsync. Publishing Jekyll-generated content to hostgator hosting is used as an example.">
<meta property="og:site_name" content="Vitaly Repin">
<meta property="og:locale" content="en_US">


  <meta property="article:published_time" content="2015-07-09T00:00:00+03:00">
  <meta property="article:author" content="606660677">
  
    <meta property="og:see_also" content="http://localhost:4000/vr/DigitalFree-Moddle/">
  
    <meta property="og:see_also" content="http://localhost:4000/vr/Kekkonen-Estonia-1964/">
  
    <meta property="og:see_also" content="http://localhost:4000/vr/Logstash-filter-external-script/">
  


<meta property="fb:admins" content="606660677">
<!-- <meta property="fb:app_id" content=""> -->


  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      How to automatically deploy static web site to the hosting &middot; Vitaly Repin
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/vr/public/css/poole.css">
  <link rel="stylesheet" href="/vr/public/css/syntax.css">
  <link rel="stylesheet" href="/vr/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/vr/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/vr/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/vr/about">About</a>
    <a class="sidebar-nav-item" href="/vr/hobbies">Hobby projects</a>
    <a class="sidebar-nav-item" href="/vr/tags">Tags</a>
    <a class="sidebar-nav-item" href="/vr/atom.xml">Feed</a>
    <a class="sidebar-nav-item" href="/vr/">Latest posts</a>

  <ul class="posts">  
	  
	   <li>  
		   <span>14 Apr 2016</span> &raquo;  
		   <a href="/vr/DigitalFree-Moddle/">  
		   Course "On the Road to the Free Digital Society" is available in Moodle and IMS Common Cartridge formats now</a>  
	   </li>  
	  
	   <li>  
		   <span>04 Apr 2016</span> &raquo;  
		   <a href="/vr/Kekkonen-Estonia-1964/">  
		   Визит президента Финляндии Кекконена в Эстонию в 1964 году</a>  
	   </li>  
	  
	   <li>  
		   <span>06 Feb 2016</span> &raquo;  
		   <a href="/vr/Logstash-filter-external-script/">  
		   How to incorporate external utility scripts into Logstash Pipeline</a>  
	   </li>  
	  
	   <li>  
		   <span>18 Sep 2015</span> &raquo;  
		   <a href="/vr/CopyrightedMonumentsFinland/">  
		   Copyrighted monuments in Finland. Why Finnish works of art are not widely represented in Wikipedia</a>  
	   </li>  
	  
	   <li>  
		   <span>04 Sep 2015</span> &raquo;  
		   <a href="/vr/Tour-de-Helsinki-2015/">  
		   Tour de Helsinki 2015. Nybörjares intryck från cykelloppet</a>  
	   </li>  
	  
	   <li>  
		   <span>03 Sep 2015</span> &raquo;  
		   <a href="/vr/Android-InsufficientSpace/">  
		   Fixing annoying Android's 'insufficient storage available' issue</a>  
	   </li>  
	  
	   <li>  
		   <span>05 Aug 2015</span> &raquo;  
		   <a href="/vr/Abo-skargard/">  
		   Åbo omnejd. Skärgårdens ringväg med cykel / Saariston Rengastie</a>  
	   </li>  
	  
	   <li>  
		   <span>30 Jul 2015</span> &raquo;  
		   <a href="/vr/IPsec-PacketLeakage/">  
		   [ipsec, iptables, ebtables] How to avoid leakage of packets addressed to/from private IP space</a>  
	   </li>  
	  
	   <li>  
		   <span>09 Jul 2015</span> &raquo;  
		   <a href="/vr/JekyllDeploy/">  
		   How to automatically deploy static web site to the hosting</a>  
	   </li>  
	  
	   <li>  
		   <span>07 Jul 2015</span> &raquo;  
		   <a href="/vr/Bagehot-ECB/">  
		   Is ECB really enemy of the euro? More on Bagehot's rule</a>  
	   </li>  
	  
	   <li>  
		   <span>29 Jun 2015</span> &raquo;  
		   <a href="/vr/JekyllMeta/">  
		   Jekyll: how to add metadata to your site</a>  
	   </li>  
	  
	   <li>  
		   <span>29 Jun 2015</span> &raquo;  
		   <a href="/vr/DisqusAddComments/">  
		   Blog comments = Disqus + Jekyll</a>  
	   </li>  
	  
	   <li>  
		   <span>24 Jun 2015</span> &raquo;  
		   <a href="/vr/Tagging/">  
		   How to implement proper blog tagging with Jekyll</a>  
	   </li>  
	  
	   <li>  
		   <span>23 Jun 2015</span> &raquo;  
		   <a href="/vr/Jekyll-is-cool/">  
		   Jekyll is cool</a>  
	   </li>  
	  
   </ul>

    

 
    
    
      
        
      
    
      
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
        
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  </nav>

  <div class="sidebar-item">
    <p>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">The content of this site </span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://vrepin.org/blog" property="cc:attributionName" rel="cc:attributionURL">Vitaly Repin</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>,
	  <time datetime="2017-02-12T05:19:33+02:00">2017</time>.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">

        <div class="container">
 <h3 class="masthead-title">
          <h3 class="masthead-title">
            <a href="/vr/" title="Home">Vitaly Repin</a>
            <small>
	
  &nbsp;&nbsp;&nbsp;
  <small><a href="/vr/about/">About</a></small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/vr/hobbies/">Hobby projects</a></small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/vr/tags/">Tags</a></small>

  &nbsp;&nbsp;&nbsp;
  <small><a href="/vr/atom.xml">Feed</a></small>

	   </small>
	</h3>
        <h3 class="masthead-title">
           <small>
	     <a href="http://localhost:4000/vr/en">English</a>
	     <a href="http://localhost:4000/vr/sv">Svenska</a>
	     <a href="http://localhost:4000/vr/ru">Русский</a>
	   </small>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">How to automatically deploy static web site to the hosting</h1>
  <span class="post-date">09 Jul 2015</span>
  <h1>The problem: publishing your web site efficiently</h1>

<p>When web site is updated on a regular basis (as it happens with blogs)  it becomes important to automate the process of uploading site to the hosting. Using cpanel or FTP is boring and
time-consuming. </p>

<p>The goal is to be able to sync the static-generated content (e.g., <em>_site</em> directory generated by <a href="http://jekyllrb.com/">Jekyll</a>) with just one command. My post refers to <a href="http://jekyllrb.com/">Jekyll</a> and <a href="http://www.hostgator.com/">hostgator</a> but the
methods suggested are not limited to these platforms &mdash; they are applicable to any static-generated web content.</p>

<a class="anchor" id="read-more"></a>

<h1>Possible solutions</h1>

<p>Three approaches are dominating:</p>

<ul>
<li>Use Jekyll-friendly web hosting. E.g., <a href="https://help.github.com/articles/using-jekyll-with-pages/">GitHub Pages</a>. In this case you just need to push Jekyll files to the repository, server takes them and builds your web site. This approach limits the number of available hosting platforms and Jekyll features which can be used. E.g., it will not be possible to install custom plugins to Jekyll.</li>
<li>Put generated web site into git repository and sync using git. Arlo Carreon <a href="http://www.arlocarreon.com/blog/git/push-git-repo-into-shared-hosting-account-like-hostgator/">describes this approach in detail</a>. It&#39;s not my choice &mdash; I find it awkward to put generated files under source version control. It also introduces stupid problems &mdash; like a need to add and remove these files from a repository, put meaningless comments for commits etc.</li>
<li>Torrents and RSS feed. This is a great method to deploy static content over many servers. Requires relatively complicated setup and is typically used with VPS servers. Probably an overkill for a simple web-site like a blog.</li>
<li>Use <a href="https://en.wikipedia.org/wiki/Rsync">rsync</a>.  This is my choice. It&#39;s fast, straight-forward and logical. It just replicates the files from your computer to the hosting server.</li>
</ul>

<p>I will describe rsync-based solution in detail. You need to have (user, non-root) ssh access to the hosting server in order to use this approach.</p>

<h1>Step 1: Install rrsync to your home folder (server-side)</h1>

<p>We will use certificate-based authorization to simplify the publishing process. It makes sense to restrict rsync access only to the directory which it is supposed to sync.</p>

<p>That&#39;s why rrsync wrapper shall be installed. If it is not already installed by your hoster you can do it yourself:</p>

<ul>
<li><a href="http://ftp.samba.org/pub/unpacked/rsync/support/rrsync">download rrsync</a></li>
<li>Put it to the bin subdirectory of your home folder  (<code>~/bin</code>)</li>
<li>Make it executable (<code>chmod +x</code>)</li>
</ul>

<h1>Step 2: Setup certificate-based ssh access (server side)</h1>

<p><a href="https://wiki.gentoo.org/wiki/SSH#Passwordless_Authentication">This process is described in a lot of places in the net</a>. I will not explain it in details here. What is different from usual approach is to put the
restriction to certificate-based authorization in <code>~/.ssh/authorized_key</code>). We will launch <code>rrsync</code> utility and supply it with the folder it shall have read-write access to:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>command=&quot;$HOME/bin/rrsync &lt;folder&gt;&quot;,no-agent-forwarding,no-port-forwarding,no-pty,no-user-rc,no-X11-forwarding ssh-rsa &lt;cert&gt;
</code></pre></div>
<p><code>&lt;folder&gt;</code> is the path to your site. E.g., <code>~/public_html/you.org/blog-html/</code>.</p>

<h1>Step 3: Rsync! (client-side)</h1>

<p>Add the script <code>transfer.sh</code> to the web site source folder:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span><span class="ch">#!/bin/sh</span>

rsync -avr --rsh<span class="o">=</span><span class="s1">&#39;ssh -p2222&#39;</span> --delete-after --delete-excluded   &lt;folder&gt; &lt;user&gt;@&lt;site&gt;:</code></pre></figure>

<p>Command line parameters are:</p>

<ul>
<li><code>--rsh=&#39;ssh -p2222&#39;</code> It is needed if your hoster provides ssh access using ssh port different from default one (e.g., this is what hostgator is doing)</li>
<li><code>&lt;folder&gt;</code> is the name of the local folder with generated web content. By default it is <code>_site/</code> for Jekyll</li>
<li><code>&lt;user&gt;</code> &mdash; ssh user name for your hosting account</li>
<li><code>&lt;site&gt;</code> &mdash; your hosting server</li>
</ul>

<p>My command line is:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span></span>rsync -avr --rsh<span class="o">=</span><span class="s1">&#39;ssh -p2222&#39;</span> --delete-after --delete-excluded   _site/ hostuser@vrepin.org:</code></pre></figure>

<p>Don&#39;t forget column &#39;:&#39; after server name!</p>

<h1>Optional step 4: exclude transfer.sh from being copied to the output folder by Jekyll</h1>

<p>This step is recommended if you use this how-to to deploy Jekyll-based web site. If you put <code>transfer.sh</code> script to the root folder of your project, Jekyll copies it to the output folder.
This behavior can be changed in <code>_config.yml</code>. Just add the following line there:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span></span><span class="c1"># Do not copy these file to the output directory</span>
<span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;transfer.sh&quot;</span><span class="p p-Indicator">,</span> <span class="nv">README.md</span><span class="p p-Indicator">]</span></code></pre></figure>

<h1>We are done!</h1>

<p>Now it&#39;s possible to publish your web site by launching <code>./transfer.sh</code> script. If your ssh certificate  is <a href="https://martin.kleppmann.com/2013/05/24/improving-security-of-ssh-private-keys.html">passphrase-protected</a>, you are asked to enter the password.</p>

<p>It was simple, wasn&#39;t it?</p>

<p>If you have any questions, comments, improvements ideas - don&#39;t hesitate to comment under this post!</p>

<p>If you liked this post, you can
<a href="https://twitter.com/intent/tweet?url=http://localhost:4000/JekyllDeploy/&text=How to automatically deploy static web site to the hosting&via=vitalyrepin" 
   target="_blank">
  share it with your followers</a> 
or 
<a href="https://twitter.com/vitalyrepin">
  follow me on Twitter</a>!</p>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
<script type="text/javascript">
anchors.options.visible = 'hoover';
anchors.options.placement = 'left';
anchors.add();
anchors.remove('.masthead-title');
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/2.3.1/picturefill.min.js"></script>









<a href="/vr/tag/blogging">#blogging</a>

<a href="/vr/tag/hostgator">#hostgator</a>

<a href="/vr/tag/hosting">#hosting</a>

<a href="/vr/tag/jekyll">#jekyll</a>





<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/vr/DigitalFree-Moddle/">
            Course "On the Road to the Free Digital Society" is available in Moodle and IMS Common Cartridge formats now
            <small>14 Apr 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/vr/Kekkonen-Estonia-1964/">
            Визит президента Финляндии Кекконена в Эстонию в 1964 году
            <small>04 Apr 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/vr/Logstash-filter-external-script/">
            How to incorporate external utility scripts into Logstash Pipeline
            <small>06 Feb 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


<!-- Analytics begin -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67139587-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Analytics end -->

 
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'vitalyrepinblog';
    
    var disqus_identifier = '/JekyllDeploy';
    var disqus_title = 'How to automatically deploy static web site to the hosting';
    var disqus_url = 'http://localhost:4000/vr/JekyllDeploy/';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
 

 <footer class="footer">
 <small>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">The content of this page </span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://vrepin.org/" property="cc:attributionName" rel="cc:attributionURL">Vitaly Repin</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>,
	  <time datetime="2017-02-12T05:19:33+02:00">2017</time>.
	  </small>
</footer>
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
